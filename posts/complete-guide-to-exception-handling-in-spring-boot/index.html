<!DOCTYPE html><html lang="custom" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="ko"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="스프링 부트 예외처리 완벽 가이드" /><meta property="og:locale" content="custom" /><meta name="description" content="회사에서 Spring Boot 관련 프로젝트를 진행하면서 스프링에서 지원하는 어노테이션 스펙이 궁금했고 우리 프로젝트엔 어떻게 적용되어 있는지 살펴보고 싶었다. 때마침 기술관련된 내용을 잘 정리한 사이트를 찾아서 예외처리 관련된 주제를 번역하면서 정리하려고 합니다. 아래 내용은 Complete Guide to Exception Handling in Spring Boot에 있던 내용을 제가 이해한 수준으로 번역한 결과입니다." /><meta property="og:description" content="회사에서 Spring Boot 관련 프로젝트를 진행하면서 스프링에서 지원하는 어노테이션 스펙이 궁금했고 우리 프로젝트엔 어떻게 적용되어 있는지 살펴보고 싶었다. 때마침 기술관련된 내용을 잘 정리한 사이트를 찾아서 예외처리 관련된 주제를 번역하면서 정리하려고 합니다. 아래 내용은 Complete Guide to Exception Handling in Spring Boot에 있던 내용을 제가 이해한 수준으로 번역한 결과입니다." /><link rel="canonical" href="https://oopty.github.io/posts/complete-guide-to-exception-handling-in-spring-boot/" /><meta property="og:url" content="https://oopty.github.io/posts/complete-guide-to-exception-handling-in-spring-boot/" /><meta property="og:site_name" content="oopty" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-16T21:40:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="스프링 부트 예외처리 완벽 가이드" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-11T23:52:50+09:00","datePublished":"2022-01-16T21:40:00+09:00","description":"회사에서 Spring Boot 관련 프로젝트를 진행하면서 스프링에서 지원하는 어노테이션 스펙이 궁금했고 우리 프로젝트엔 어떻게 적용되어 있는지 살펴보고 싶었다. 때마침 기술관련된 내용을 잘 정리한 사이트를 찾아서 예외처리 관련된 주제를 번역하면서 정리하려고 합니다. 아래 내용은 Complete Guide to Exception Handling in Spring Boot에 있던 내용을 제가 이해한 수준으로 번역한 결과입니다.","headline":"스프링 부트 예외처리 완벽 가이드","mainEntityOfPage":{"@type":"WebPage","@id":"https://oopty.github.io/posts/complete-guide-to-exception-handling-in-spring-boot/"},"url":"https://oopty.github.io/posts/complete-guide-to-exception-handling-in-spring-boot/"}</script><title>스프링 부트 예외처리 완벽 가이드 | oopty</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="oopty"><meta name="application-name" content="oopty"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /commons/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">oopty</a></div><div class="site-subtitle font-italic">Stand on the shoulders of giants</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/oopty" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['minjun13795','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>스프링 부트 예외처리 완벽 가이드</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img data-src="/assets/images/20220116_404-not-found.jpg" class="preview-img bg" alt="404에러" data-proofer-ignore><h1 data-toc-skip>스프링 부트 예외처리 완벽 가이드</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/oopty">oopty</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1642336800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-01-16 </em> </span> <span> Updated <em class="timeago" data-ts="1647010370" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-11 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5365 words"> <em>29 min</em> read</span></div></div></div><div class="post-content"><p>회사에서 <code class="language-plaintext highlighter-rouge">Spring Boot</code> 관련 프로젝트를 진행하면서 스프링에서 지원하는 어노테이션 스펙이 궁금했고 우리 프로젝트엔 어떻게 적용되어 있는지 살펴보고 싶었다. 때마침 기술관련된 내용을 잘 정리한 사이트를 찾아서 예외처리 관련된 주제를 번역하면서 정리하려고 합니다. 아래 내용은 <a href="https://reflectoring.io/spring-boot-exception-handling/#responsestatus">Complete Guide to Exception Handling in Spring Boot</a>에 있던 내용을 제가 이해한 수준으로 번역한 결과입니다.</p><p>예외 처리는 탄탄한 어플리케이션을 만드는데 중요한 부분을 차지합니다. 스프링 부트에선 여러가지 방법을 제시합니다. 이 글에선 여러가지 방법을 시험해보고 다른 방법보다 더 선호되는 방법이 있을 땐 제안도 드릴겁니다.</p><h2 id="예시-코드"><span class="mr-2">예시 코드</span><a href="#예시-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>이 글은 GitHub에 있는 <a href="https://github.com/thombergs/code-examples/tree/master/spring-boot/exception-handling">동작 코드</a>를 제공합니다.</p><h2 id="소개"><span class="mr-2">소개</span><a href="#소개" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>스프링 부트는 단순한 <code class="language-plaintext highlighter-rouge">try=catch</code>를 넘어선 예외처리 도구를 제공합니다. 이러한 도구를 이용하기 위해 우리는 관점을 분리로서 예외처리를 다루는 몇가지 어노테이션을 사용합니다.</p><ul><li><code class="language-plaintext highlighter-rouge">@ResponseStatus</code><li><code class="language-plaintext highlighter-rouge">@ExceptionHandler</code><li><code class="language-plaintext highlighter-rouge">@ControllerAdvice</code></ul><p>어노테이션들을 보기 전에 우리는 먼저 스프링이 어떻게 웹 컨트롤러에서 던저진 에러를 처리하는지 살펴볼것입니다 - 에러를 처리하는 마지막 단계</p><p>또한 기본 설정을 바꾸기위해 스프링 부트에서 제공하는 몇가지 설정도 살펴볼 예정입니다.</p><p>우리가 예외를 처리하면서 겪는 어려움을 인지하고나서 우리는 어노테이션으로 해결할 겁니다.</p><h2 id="스프링-부트-기본-예외처리-메커니즘"><span class="mr-2">스프링 부트 기본 예외처리 메커니즘</span><a href="#스프링-부트-기본-예외처리-메커니즘" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>주어진 id가 없을 때 <code class="language-plaintext highlighter-rouge">NoSuchElementException</code> 런타임 에러를 던지는 <code class="language-plaintext highlighter-rouge">getProduct</code> 메서드를 가지고 있는 <code class="language-plaintext highlighter-rouge">ProductController</code>가 있다고 가정해봅시다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductController</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ProductService</span> <span class="n">productService</span><span class="o">;</span>
  <span class="c1">//constructor omitted for brevity...</span>
  
  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">getProduct</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">){</span>
    <span class="c1">// this method throws a "NoSuchElementFoundException" exception</span>
    <span class="k">return</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>
  
<span class="o">}</span>
</pre></table></code></div></div><p>우리가 유효하지 않은 id로 <code class="language-plaintext highlighter-rouge">/product</code> API를 호출하면 <code class="language-plaintext highlighter-rouge">NoSuchElementFoundException</code> 런타임 에러를 발생시킬거고 다음 Response를 얻게될 겁니다.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-28T13:24:02.239+00:00"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Internal Server Error"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/product/1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>페이로드는 올바른 형식의 에러 메시지 외에 어떤 정보도 주지 않습니다. 심지어 <code class="language-plaintext highlighter-rouge">message</code>필드는 비어있지만 우리는 “Item with id 1 not found”같은 것을 포함하길 기대합니다.</p><p>이 에러 메시지 이슈를 고쳐봅시다.</p><p>스프링 부트는 우리가 에러 메시지, 에러 클래스 또는 Response 페이로드의 스택 트레이스 일부를 더할 수 있는 몇가지 속성을 제공합니다.</p><div class="language-yml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="na">server</span><span class="pi">:</span>
  <span class="na">error</span><span class="pi">:</span>
  <span class="na">include-message</span><span class="pi">:</span> <span class="s">always</span>
  <span class="na">include-binding-errors</span><span class="pi">:</span> <span class="s">always</span>
  <span class="na">include-stacktrace</span><span class="pi">:</span> <span class="s">on_trace_param</span>
  <span class="na">include-exception</span><span class="pi">:</span> <span class="no">false</span>
</pre></table></code></div></div><p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.server">스프링 부트 서버 속성</a>을 사용하면 에러 메시지를 어느 정도 바꿀 수 있습니다.</p><p>지금 유효하지 않은 id로 <code class="language-plaintext highlighter-rouge">/product</code> API를 요청하면 다음 리스폰스를 받게 됩니다.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-29T09:42:12.287+00:00"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Internal Server Error"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Item with id 1 not found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/product/1"</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span></pre></table></code></div></div><p>우리가 <code class="language-plaintext highlighter-rouge">include-stacktrace</code>를 <code class="language-plaintext highlighter-rouge">on_trace_param</code>로 설정한 것을 기억하세요. 이것이 의미하는 바는 url에 trace 파라미터를 포함하는 경우(?trace=true), 리스폰스 페이로드에서 스텍 트레이스를 얻을 수 있다는 것입니다.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-29T09:42:12.287+00:00"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Internal Server Error"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Item with id 1 not found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"trace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"io.reflectoring.exception.exception.NoSuchElementFoundException: Item with id 1 not found..."</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/product/1"</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span></pre></table></code></div></div><p>우리는 적어도 운영 제품에서는 <code class="language-plaintext highlighter-rouge">include-stacktrace</code>를 <code class="language-plaintext highlighter-rouge">never</code>로 유지하고 싶을 수 있습니다. 우리 어플리케이션의 내부 동작을 들어낼 수 있기 때문입니다.</p><p>문제는 계속 있습니다! 상태 코드(500)은 서버 코드에서 무언가 이상하다는 것을 가르키지만, 실제로는 클라이언트가 유효하지 않은 id를 전달했기 때문입니다.</p><p>우리의 현재 에러 메시지 상태 코드는 이런 정보를 정확히 전달하지 않습니다. 불행히도 <code class="language-plaintext highlighter-rouge">server.error</code> 설정 속성으로 하는 한 이정도만 적용되므로, 스프링 부트에서 제공하는 어노테이션들을 살펴봐야 합니다.</p><h2 id="responsestatus"><span class="mr-2">ResponseStatus</span><a href="#responsestatus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>이름 그대로, <code class="language-plaintext highlighter-rouge">@ResponseStatus</code> 응답 리스폰스의 HTTP status를 수정할 수 있게 해줍니다. 아래 위치에 적용 가능합니다.</p><ul><li>예외 클래스에서<li><code class="language-plaintext highlighter-rouge">@ExceptionHanlder</code> 어노테이션을 가진 메서드에서<li><code class="language-plaintext highlighter-rouge">@ControllerAdvice</code> 어노테이션을 가진 클래스에서</ul><p>이번 섹션에선, 첫번째 경우를 살펴볼 것 입니다.</p><p>다시 문제상황으로 돌아와보면, 우리 에러 리스폰스는 더 설명적인 status code 대신 항상 HTTP status 500인 것 입니다.</p><p>이 문제를 해결하기 위해, 우리는 예외 클래스에 <code class="language-plaintext highlighter-rouge">@ResponseStatus</code>를 함께 사용하고 <code class="language-plaintext highlighter-rouge">value</code> 속성에 원하는 HTTP status를 넣어주면 됩니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nd">@ResponseStatus</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoSuchElementFoundException</span> <span class="kd">extends</span> <span class="nc">RuntimeException</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></table></code></div></div><p>만약 우리가 유효하지 않은 id로 controller를 호출한다면, 이 수정사항이 더 나은 리스폰스 가져올 것입니다.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-29T09:42:12.287+00:00"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Not Found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Item with id 1 not found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/product/1"</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span></pre></table></code></div></div><p>같은 결과를 만드는 또 다른 방법은 <code class="language-plaintext highlighter-rouge">ReponseStatusException</code> 클래스를 상속받는 것입니다</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoSuchElementFoundException</span> <span class="kd">extends</span> <span class="nc">ResponseStatusException</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nf">NoSuchElementFoundException</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">){</span>
    <span class="kd">super</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">HttpHeaders</span> <span class="nf">getResponseHeaders</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// return response headers</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">getResponseHeaders()</code> 메서드를 오버라이드 할 수 있기 때문에 HTTP header를 조종하려고 할 때 이 접근방법은 유용합니다.</p><p>하지만 리스폰스 페이로드 구조도 수정하고 싶다면 어떻게 해야할 까요?</p><p>다음 섹션에서 어떻게 해결할 수 있는지 살펴봅시다.</p><h2 id="exceptionhandler"><span class="mr-2">@ExceptionHandler</span><a href="#exceptionhandler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">@ExceptionHandler</code> 어노테이션은 예외 처리에 관해서 많은 유연성을 줍니다. 초보자로서 이것을 사용하려면, <code class="language-plaintext highlighter-rouge">@ControllerAdvice</code> 클래스나 컨트롤러 자체에서 매서드 하나를 만들면 됩니다. 그리고 그 메서드에 <code class="language-plaintext highlighter-rouge">@ExceptionHandler</code> 어노테이션을 붙혀줍니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductController</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ProductService</span> <span class="n">productService</span><span class="o">;</span>

  <span class="c1">// Constructor omitted for breviy...</span>

  <span class="nd">@Getmapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">getProduct</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">NoSuchElementFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">handleNoSuchElementNotFoundException</span><span class="o">(</span>
    <span class="nc">NoSuchElementNotFoundException</span> <span class="n">exception</span>
  <span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">ReponseEntity</span>
      <span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">)</span>
      <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>예외 핸들러 메서드는 정의된 메서드에서 다루기를 원하는 예외나 예외 리스트를 인자로 받습니다. 이 메서드를 <code class="language-plaintext highlighter-rouge">@ResponseHandler</code>와 <code class="language-plaintext highlighter-rouge">@ResponseStatus</code>와 함께 지정해서 우리가 다루기 원하는 예외와 반환하려는 상태코드를 정의합니다.</p><p>만약 이러한 어노테이션을 사용하고 싶지 않다면, 메서드의 인자로 간단히 정의하는 방법도 똑같이 동작합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nd">@ExceptionHandler</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">handleNoSuchElementNotFoundexception</span><span class="o">(</span>
  <span class="nc">NoSuchElementFoundException</span> <span class="n">exception</span>
<span class="o">)</span>
</pre></table></code></div></div><p>하지만 메서드 시그니쳐에서 이미 예외 클래스를 정의했지만 어노테이션에 예외 클래스를 정의하는 것은 더 좋은 가독성을 위해 좋은 생각입니다.</p><p>또한 핸들러 메서드에 <code class="language-plaintext highlighter-rouge">ResponseStatus(HTTPStatus.NOT_FOUND)</code> 어노테이션은 ResponseEntity로 전달한 HTTP 상태가 우선되므로 필요 없습니다. 하지만 가독성을 위해 우리는 그대로 두겠습니다.</p><p>예외처리 파라미터와는 별도로, <code class="language-plaintext highlighter-rouge">HttpServletRequest</code>, <code class="language-plaintext highlighter-rouge">WebRequest</code> or <code class="language-plaintext highlighter-rouge">HttpSession</code>을 파라미터로 받을 수 있습니다.</p><p>더불어, 핸들러 메서드는 <code class="language-plaintext highlighter-rouge">ResponseEntity</code>, <code class="language-plaintext highlighter-rouge">String</code> 또는 <code class="language-plaintext highlighter-rouge">void</code>처럼 다양한 반환 타입을 지원합니다.</p><p>더 많은 입력과 반환 타입을 <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/ExceptionHandler.html">@ExceptionHandler java documentation</a>에서 찾아보세요.</p><p>예외처리에서 입력과 반환 타입의 형태에 다양한 옵션을 이용 가능하므로, 우리는 에러 응답을 완벽히 제어할 수 있습니다.</p><p>이제 우리 API의 에러 리스폰스를 완성해봅시다. 어떤 경우에는, 사용자는 두 가지를 기대합니다.</p><ul><li>에러 코드는 사용자에게 어떤 종류의 에러인지 알려줍니다. 에러 코드는 클라이언트 단에서 어떤 비지니스 로직을 수행할 지 결정합니다. 대게 에러코드는 표준 HTTP status 코드를 사용하지만, E001처럼 사용자 지정 에러 코드를 반환하는 것도 보았습니다.<li>에러에 대해 더 많은 정보를 주는 추가적인 인간 친화적 메시지이고 어떻게 고칠지에 대한 힌트와 API 링크입니다.</ul><p>우리는 또 <code class="language-plaintext highlighter-rouge">stackTrace</code> 필드를 더하므로써 개발환경에서 디버깅을 도와줄 수 있습니다.</p><p>마지막으로 우리가 검증 에러에 대해 다루고 싶다면 빈 검증 시스템에 대해 <a href="https://reflectoring.io/bean-validation-with-spring-boot/">Handling Validations with Spring Boot</a>에서 더 많은 정보를 찾을 수 있습니다.</p><p>위 상황을 계속 상기하면서 에러 응당에 대해 다음 페이로드를 사용할 것입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@JsonInclude</span><span class="o">(</span><span class="nc">JsonInclude</span><span class="o">.</span><span class="na">Include</span><span class="o">.</span><span class="na">NON_NULL</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ErrorResponse</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">status</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">stackTrace</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ValidationError</span><span class="o">&gt;</span> <span class="n">errors</span><span class="o">;</span>

  <span class="nd">@Getter</span>
  <span class="nd">@Setter</span>
  <span class="nd">@RequiredArgsConstructor</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ValidationError</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">field</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addValidationError</span><span class="o">(</span><span class="nc">String</span> <span class="n">field</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">){</span>
    <span class="k">if</span><span class="o">(</span><span class="nc">Objects</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">errors</span><span class="o">)){</span>
      <span class="n">errors</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>
    <span class="n">errors</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">ValidationError</span><span class="o">(</span><span class="n">field</span><span class="o">,</span> <span class="n">message</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 이거를 <code class="language-plaintext highlighter-rouge">NoSuchElementNotFoundException</code> 핸들러 메서드에 적용해봅시다</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre><td class="rouge-code"><pre><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/product"</span><span class="o">)</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductController</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">TRACE</span> <span class="o">=</span> <span class="s">"trace"</span><span class="o">;</span>

  <span class="nd">@Value</span><span class="o">(</span><span class="s">"${reflectoring.trace:false}"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">printStackTrace</span><span class="o">;</span>
  
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ProductService</span> <span class="n">productService</span><span class="o">;</span>

  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">Product</span> <span class="nf">getProduct</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">){</span>
    <span class="k">return</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@PostMapping</span>
  <span class="kd">public</span> <span class="nc">Product</span> <span class="nf">addProduct</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="nc">ProductInput</span> <span class="n">input</span><span class="o">){</span>
    <span class="k">return</span> <span class="n">productService</span><span class="o">.</span><span class="na">addProduct</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">NoSuchElementFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleItemNotFoundException</span><span class="o">(</span>
      <span class="nc">NoSuchElementFoundException</span> <span class="n">exception</span><span class="o">,</span> 
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">){</span>
    <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Failed to find the requested element"</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
    <span class="k">return</span> <span class="nf">buildErrorResponse</span><span class="o">(</span><span class="n">exception</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">MethodArgumentNotValidException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">UNPROCESSABLE_ENTITY</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleMethodArgumentNotValid</span><span class="o">(</span>
      <span class="nc">MethodArgumentNotValidException</span> <span class="n">ex</span><span class="o">,</span>
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">)</span> <span class="o">{</span>
    <span class="nc">ErrorResponse</span> <span class="n">errorResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ErrorResponse</span><span class="o">(</span>
        <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">UNPROCESSABLE_ENTITY</span><span class="o">.</span><span class="na">value</span><span class="o">(),</span> 
        <span class="s">"Validation error. Check 'errors' field for details."</span>
    <span class="o">);</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="nc">FieldError</span> <span class="n">fieldError</span> <span class="o">:</span> <span class="n">ex</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">().</span><span class="na">getFieldErrors</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">errorResponse</span><span class="o">.</span><span class="na">addValidationError</span><span class="o">(</span><span class="n">fieldError</span><span class="o">.</span><span class="na">getField</span><span class="o">(),</span> 
          <span class="n">fieldError</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">unprocessableEntity</span><span class="o">().</span><span class="na">body</span><span class="o">(</span><span class="n">errorResponse</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleAllUncaughtException</span><span class="o">(</span>
      <span class="nc">Exception</span> <span class="n">exception</span><span class="o">,</span> 
      <span class="nc">WebRequest</span> <span class="n">request</span><span class="o">){</span>
    <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Unknown error occurred"</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
    <span class="k">return</span> <span class="nf">buildErrorResponse</span><span class="o">(</span>
        <span class="n">exception</span><span class="o">,</span>
        <span class="s">"Unknown error occurred"</span><span class="o">,</span> 
        <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">,</span> 
        <span class="n">request</span>
    <span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">buildErrorResponse</span><span class="o">(</span>
      <span class="nc">Exception</span> <span class="n">exception</span><span class="o">,</span>
      <span class="nc">HttpStatus</span> <span class="n">httpStatus</span><span class="o">,</span>
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">buildErrorResponse</span><span class="o">(</span>
        <span class="n">exception</span><span class="o">,</span> 
        <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> 
        <span class="n">httpStatus</span><span class="o">,</span> 
        <span class="n">request</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">buildErrorResponse</span><span class="o">(</span>
      <span class="nc">Exception</span> <span class="n">exception</span><span class="o">,</span>
      <span class="nc">String</span> <span class="n">message</span><span class="o">,</span>
      <span class="nc">HttpStatus</span> <span class="n">httpStatus</span><span class="o">,</span>
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">)</span> <span class="o">{</span>
    <span class="nc">ErrorResponse</span> <span class="n">errorResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ErrorResponse</span><span class="o">(</span>
        <span class="n">httpStatus</span><span class="o">.</span><span class="na">value</span><span class="o">(),</span> 
        <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span>
    <span class="o">);</span>
    
    <span class="k">if</span><span class="o">(</span><span class="n">printStackTrace</span> <span class="o">&amp;&amp;</span> <span class="n">isTraceOn</span><span class="o">(</span><span class="n">request</span><span class="o">)){</span>
      <span class="n">errorResponse</span><span class="o">.</span><span class="na">setStackTrace</span><span class="o">(</span><span class="nc">ExceptionUtils</span><span class="o">.</span><span class="na">getStackTrace</span><span class="o">(</span><span class="n">exception</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="n">httpStatus</span><span class="o">).</span><span class="na">body</span><span class="o">(</span><span class="n">errorResponse</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isTraceOn</span><span class="o">(</span><span class="nc">WebRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="o">[]</span> <span class="n">value</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameterValues</span><span class="o">(</span><span class="no">TRACE</span><span class="o">);</span>
    <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">nonNull</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
        <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">contentEquals</span><span class="o">(</span><span class="s">"true"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>고려해야할 사항들을 여기에 말해보겠습니다.</p><h2 id="스택-트레이스-제공"><span class="mr-2">스택 트레이스 제공</span><a href="#스택-트레이스-제공" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>스택 트레이스를 제공하는 것은 개발자와 QA 엔지니어가 로그파일을 살펴보는 시간을 구할 수 있습니다. 스프링 기본 예외 처리 메커니즘에서 본 것처럼 스프링은 이미 우리에게 기능을 제공합니다. 하지만 이제 에러 응답을 직접 다룬 것 처럼 이것도 직접 다뤄지길 필요가 있습니다.</p><p>그러기 위해, <code class="language-plaintext highlighter-rouge">refactoring.trace</code> 서버-사이드 속성을 소개할 것입니다. 이것은 <code class="language-plaintext highlighter-rouge">true</code>로 설정되면 응답에서 <code class="language-plaintext highlighter-rouge">stackTrace</code>를 필드를 제공합니다. 실제로 API에서 <code class="language-plaintext highlighter-rouge">stackTrace</code>를 얻기 위해서는 클라이언트는 추가적으로 <code class="language-plaintext highlighter-rouge">trace</code> 파라미터를 <code class="language-plaintext highlighter-rouge">true</code>로 보내야 합니다.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">--location</span> <span class="nt">--request</span> GET <span class="s1">'http://localhost:8080/product/1?trace=true
</span></pre></table></code></div></div><p>이제는 <code class="language-plaintext highlighter-rouge">stackTrace</code>의 기능은 우리 속성 파일의 기능 플래그에 의해 제어되므로 우리는 그것을 운영 환경에서는 삭제하거나 <code class="language-plaintext highlighter-rouge">false</code>로 설정할 수 있습니다.</p><h2 id="모든-에러-잡기"><span class="mr-2">모든 에러 잡기</span><a href="#모든-에러-잡기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Gotta catch em all:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">try</span><span class="o">{</span>
  <span class="n">performSomeOperation</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">OperationSpecificException</span> <span class="n">ex</span><span class="o">){</span>
  <span class="c1">//...</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">catchAllExcetion</span><span class="o">){</span>
  <span class="c1">//...  </span>
<span class="o">}</span>
</pre></table></code></div></div><p>예방조치로 우리는 때때로 원하지 않는 부작용이나 기능을 피하기 위해, 상위 메서드를 모든 에러를 잡는 블럭으로 감쌉니다. 우리 컨트롤러에서 <code class="language-plaintext highlighter-rouge">handleAllUncaughtException()</code> 메서드는 비슷하게 동작합니다. 이것은 우리가 특정한 메서드가 연결되지 않은 모든 예외를 잡습니다.</p><p>여기서 말하고 싶은 한가지는 우리가 만약 이 메서드를 사용하지 않더라도 스프링이 모든 예외를 처리할 것입니다. 하지만 우리는 응답 형식이 스프링의 형식보다는 우리 형식을 따르기를 원하기 때문에 이 메서드를 정의해야 합니다.</p><p>이 메서드는 가능한 버그에 대해 통찰을 제공하는 예외를 로깅하는데 좋은 곳입니다. <code class="language-plaintext highlighter-rouge">MethodArgumentNotValidException</code>같은 검증 예외는 스킵할 수 있습니다. 왜냐하면 문법적으로 유효하지 않은 입력에 의해 생기기 때문입니다. 하지만 예상치 못한 예외는 이 catch-all 핸들러 에서 로깅해야합니다.</p><h3 id="예외-처리의-순서"><span class="mr-2">예외 처리의 순서</span><a href="#예외-처리의-순서" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>예외를 처리하는 순서는 중요하지 않습니다. <strong>스프링은 첫번째로 해당 에러와 가장 일치하는 핸들러 메서드를 찾습니다.</strong></p><p>만약 찾지 못한다면 부모 클래스의 핸들러를 찾습니다. 우리 경우에는 <code class="language-plaintext highlighter-rouge">RuntimeException</code>이 되겠죠. 그리고 아무것도 찾지 못한다면, <code class="language-plaintext highlighter-rouge">hhandleAllUncaughtException()</code> 메서드가 최종적으로 예외를 처리할 것입니다.</p><p>이건 우리가 특정 컨트롤러 안에서 예외 처리를 다룰 때 도움이 될 것입니다. 그런데 똑같은 예외가 다른 컨트롤러에서 발생한다면 어떨까요? 이것을 어떻게 처리해야 할 까요? 우리는 같은 핸들러 메서드를 모든 컨트롤러에서 만들어야 할까요? 아니면 공통 핸들러 메서드를 가진 부모 클래스를 만든 다음 모든 클래스에서 이것을 상속해야할 까요?</p><p>운이 좋게도 이렇게 하지 않아도 됩니다. 스프링은 “controller advice”의 형태로 매우 우아한 해결책을 제공합니다.</p><h2 id="controlleradvice"><span class="mr-2">@ControllerAdvice</span><a href="#controlleradvice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><h3 id="왜-controlleradvice-일까"><span class="mr-2">왜 ControllerAdvice 일까?</span><a href="#왜-controlleradvice-일까" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>‘Advice’라는 말은 AOP에서 나온 말입니다. 이 AOP는 Aspect-Oriented Programming이라고 메서드들에 횡단 코드로 주입(Advice)할 수 있는 기법이다. ControllerAdivce는 우리의 예외 처리 경우에서 중간에 끼어들어 컨트럴로 메서드들의 반환 값을 수정할 수 있게 해줍니다.</p></blockquote><p>ControllerAdivce는 우리가 예외 핸들러를 우리 어플리케이션의 하나 이상 또는 모든 클래스에 적용할 수 있게 해줍니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="kd">extends</span> <span class="nc">ResponseEntityExceptionHandler</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">TRACE</span> <span class="o">=</span> <span class="s">"trace"</span><span class="o">;</span>

  <span class="nd">@Value</span><span class="o">(</span><span class="s">"${reflectoring.trace:false}"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">printStackTrace</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">UNPROCESSABLE_ENTITY</span><span class="o">)</span>
  <span class="kd">protected</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">handleMethodArgumentNotValid</span><span class="o">(</span>
      <span class="nc">MethodArgumentNotValidException</span> <span class="n">ex</span><span class="o">,</span>
      <span class="nc">HttpHeaders</span> <span class="n">headers</span><span class="o">,</span>
      <span class="nc">HttpStatus</span> <span class="n">status</span><span class="o">,</span>
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">)</span> <span class="o">{</span>
      <span class="c1">//Body omitted as it's similar to the method of same name</span>
      <span class="c1">// in ProductController example...  </span>
      <span class="c1">//.....</span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">ItemNotFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">handleItemNotFoundException</span><span class="o">(</span>
      <span class="nc">ItemNotFoundException</span> <span class="n">itemNotFoundException</span><span class="o">,</span> 
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">){</span>
      <span class="c1">//Body omitted as it's similar to the method of same name</span>
      <span class="c1">// in ProductController example...  </span>
      <span class="c1">//.....  </span>
  <span class="o">}</span>

  <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">RuntimeException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">handleAllUncaughtException</span><span class="o">(</span>
      <span class="nc">RuntimeException</span> <span class="n">exception</span><span class="o">,</span> 
      <span class="nc">WebRequest</span> <span class="n">request</span>
  <span class="o">){</span>
      <span class="c1">//Body omitted as it's similar to the method of same name</span>
      <span class="c1">// in ProductController example...  </span>
      <span class="c1">//.....</span>
  <span class="o">}</span>
  
  <span class="c1">//....</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">handleExceptionInternal</span><span class="o">(</span>
      <span class="nc">Exception</span> <span class="n">ex</span><span class="o">,</span>
      <span class="nc">Object</span> <span class="n">body</span><span class="o">,</span>
      <span class="nc">HttpHeaders</span> <span class="n">headers</span><span class="o">,</span>
      <span class="nc">HttpStatus</span> <span class="n">status</span><span class="o">,</span>
      <span class="nc">WebRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>

    <span class="k">return</span> <span class="nf">buildErrorResponse</span><span class="o">(</span><span class="n">ex</span><span class="o">,</span><span class="n">status</span><span class="o">,</span><span class="n">request</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p>@ExceptionHanlder쳅터에서 보여준 코드와 거의 비슷하기 때문에 핸들러 메서드와 그 외 다른 메서드의 바디 부분은 생략되었습니다. 깃헙 레포지토리 <a href="https://github.com/thombergs/code-examples/blob/master/spring-boot/exception-handling/src/main/java/io/reflectoring/exception/exception/GlobalExceptionHandler.java"><code class="language-plaintext highlighter-rouge">GlobalExceptionHanlder</code> class</a>에서 전체 코드를 보실 수 있습니다.</p><p>잠시후 우리가 얘기할 새로운 것들이 있습니다. 하나의 큰 차이점은 이 핸들러는 <code class="language-plaintext highlighter-rouge">ProductController</code>에 국한되지 않고 어플리케이션의 모든 컨트롤러에서 발생하는 에러를 처리합니다.</p><p>만약 우리가 선택적으로 ControllerAdvice의 영역을 특정 컨트롤러나 패키지에 제한하고 적용하고 싶다면, 우리는 어노테이션에서 제공되는 프로퍼티를 사용할 수 있습니다.</p><ul><li>@ContollerAdvice(“com.reflectoring.controller”): 우리는 패키지의 이름이나 패키지 이름 리스트를 어노테이션의 <code class="language-plaintext highlighter-rouge">value</code>나 <code class="language-plaintext highlighter-rouge">basePackages</code>에 전달 할 수 있습니다. ControllerAdvice는 해당 패키지 컨트롤러의 예외만 처리합니다.<li>@ControllerAdvice(annotations = Advised.class): 오직 <code class="language-plaintext highlighter-rouge">@Advised</code> 어노테이션된 클래스의 예외만 ControllerAdvice에 의해 처리될 것 입니다.</ul><p><a href="https://www.javadoc.io/doc/org.springframework/spring-web/4.3.8.RELEASE/org/springframework/web/bind/annotation/ControllerAdvice.html">@ControllerAdvice 어노테이션 문서</a>에서 다른 파라미터를 찾아보세요.</p><h2 id="responseentityexceptionhanlder"><span class="mr-2">ResponseEntityExceptionHanlder</span><a href="#responseentityexceptionhanlder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">ResponseEntityExceptionHanlder</code>는 <code class="language-plaintext highlighter-rouge">ControllerAdvice</code>의 편리한 기본 클래스입니다. 이것은 내부 스프링 예외를 위해 예외처리를 제공합니다. 만약 우리가 이것을 상속하지 않는다면, 모든 예외는 <code class="language-plaintext highlighter-rouge">ModelAndView</code>를 반환하는 <code class="language-plaintext highlighter-rouge">DefaultHandlerExceptionResolver</code>로 리다이렉트 됩니다. 우리는 우리의 에러 응답을 만드는 것이 목표이기 때문에 이렇게 하지 않겠습니다.</p><p>보시다시피, 우리는 ResponseEntityExceptionHandler의 두가지 메서드를 오버라이드하고 있습니다.</p><ul><li>handleMethodArgumentNotValid(): <code class="language-plaintext highlighter-rouge">@ExceptionHandler</code> 쳅터에서는 이것을 바로 구현했습니다. 여기서는 단지 이것의 기능을 재정의했습니다.<li>handleExceptionInternal(): ResponseEntityExceptionHandlerd의 모든 핸들러가 우리의 buildErrorReponse()처럼 ReponseEntity를 만들기 위해 이 함수를 사용합니다. 만약 이것을 오버라이드하지 않는다면 클라이언트는 응답 헤더에 Http 상태를 받을 수 있을 것입니다. 하지만 우리는 응답 바디에 Http 상태를 포함하기를 원하니까 이 메서드를 오버라이드했습니다.</ul><blockquote><h2 id="nohandlerfoundexception를-처리하는-것은-몇-가지-추가-단계가-더-필요합니다"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">NoHandlerFoundException</code>를 처리하는 것은 몇 가지 추가 단계가 더 필요합니다.</span><a href="#nohandlerfoundexception를-처리하는-것은-몇-가지-추가-단계가-더-필요합니다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>이 에외는 우리의 시스템에 존재하지 않는 API를 요청하는 경우 일어납니다. <code class="language-plaintext highlighter-rouge">ResponseEntityExceptionHandler</code> 클래스를 통해 이 핸들러를 정의해도 이 에외는 <code class="language-plaintext highlighter-rouge">DefaultHandlerExceptionResolver</code>로 리다이렉트 됩니다. 우리 advice로 리다이렉트 시키기 위해서는 우리 속성 파일에서 몇 가지 속성을 설정해줘야합니다: <code class="language-plaintext highlighter-rouge">spring.mvc.throw-exception-if-no-handler-found=true</code>과 <code class="language-plaintext highlighter-rouge">spring.web.resources.add-mappings=false</code> credit: <a href="https://stackoverflow.com/questions/36733254/spring-boot-rest-how-to-configure-404-resource-not-found">Stackoverflow user mengchengfeng</a></p></blockquote><h2 id="controlleradvice를-사용하면서-몇-가지-고려해야할-점"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">@ControllerAdvice</code>를 사용하면서 몇 가지 고려해야할 점</span><a href="#controlleradvice를-사용하면서-몇-가지-고려해야할-점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>단순하게 유지하는 방법은 항상 프로젝트에 오직 하나의 advice 클래스를 가지는 것입니다. 어플리케이션에 모든 예외의 하나의 레포지토리를 갖는 것은 좋은 방법입니다. 많은 ControllerAdvice를 만드는 경우, 어떤 Controller에서 발생한 예외를 처리할지 명확하게 하기 위해 <code class="language-plaintext highlighter-rouge">basePackages</code>와 <code class="language-plaintext highlighter-rouge">value</code>를 사용하세요.<li>우리가 <code class="language-plaintext highlighter-rouge">@Order</code> 어노테이션으로 어노테이션을 추가하지 않는 한 <strong>스프링은 어떤 순서로든 controller advice를 처리할 수 있습니다.</strong> 그래서 만약 여러 개의 controller advice가 있다면 catch-all 핸들러를 작성할 때 주의하세요. 특히 어노테이션에 특정한 <code class="language-plaintext highlighter-rouge">basePackage</code>나 <code class="language-plaintext highlighter-rouge">value</code>를 지정하지 않았을 때 더욱 주의하세요</ul><h2 id="어떻게-스프링은-예외를-처리하나"><span class="mr-2">어떻게 스프링은 예외를 처리하나?</span><a href="#어떻게-스프링은-예외를-처리하나" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>이제 우리는 스프링에서 우리가 예외를 처리할 수 있는 매커니즘에 대해 설명했습니다. 어떻게 스프링이 처리하는지와 언제 한 매커니즘이 다른 매커니즘보다 우선시 되는지 짧게 이해해봅시다. 우리가 우리 자신의 예외 처리 핸들러를 만들지 않은 경우 예외 처리의 과정을 추적한 아래에 플로우 차트를 봅시다.</p><p><img data-src="/assets/images/20220116_how-spring-process-exception.png" alt="스프링 예외 처리 매커니즘" data-proofer-ignore></p><h2 id="결론"><span class="mr-2">결론</span><a href="#결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>예외가 컨트롤러의 경계를 넘어설 때 이 예외는 JSON 포멧이나 HTML 웹 페이지 형태로 클라이언트로 도달할 예정입니다.</p><p>이 게시글에서는, 어떻게 스프링이 이러한 예외를 우리 사용자들을 위해 사용자 친화적인 결과로 바꿀 수 있는지와 우리가 원하는 형식으로 더 성형할 수 있는 어노테이션에 대해 보았습니다.</p><p>읽어주셔서 감사합니다!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>java</a>, <a href='/categories/spring/'>spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/excpetion-handling/" class="post-tag no-text-decoration" >excpetion handling</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/controlleradvice/" class="post-tag no-text-decoration" >controlleradvice</a> <a href="/tags/anotation/" class="post-tag no-text-decoration" >anotation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EC%8A%A4%ED%94%84%EB%A7%81+%EB%B6%80%ED%8A%B8+%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC+%EC%99%84%EB%B2%BD+%EA%B0%80%EC%9D%B4%EB%93%9C+-+oopty&url=https%3A%2F%2Foopty.github.io%2Fposts%2Fcomplete-guide-to-exception-handling-in-spring-boot%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EC%8A%A4%ED%94%84%EB%A7%81+%EB%B6%80%ED%8A%B8+%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC+%EC%99%84%EB%B2%BD+%EA%B0%80%EC%9D%B4%EB%93%9C+-+oopty&u=https%3A%2F%2Foopty.github.io%2Fposts%2Fcomplete-guide-to-exception-handling-in-spring-boot%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Foopty.github.io%2Fposts%2Fcomplete-guide-to-exception-handling-in-spring-boot%2F&text=%EC%8A%A4%ED%94%84%EB%A7%81+%EB%B6%80%ED%8A%B8+%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC+%EC%99%84%EB%B2%BD+%EA%B0%80%EC%9D%B4%EB%93%9C+-+oopty" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/effective-java-item-1/">Effective Java 정리 Item1</a><li><a href="/posts/gc-tuning/">가비지 컬렉터 튜닝</a><li><a href="/posts/java-study1/">함수형 프로그래밍의 의미와 장점</a><li><a href="/posts/javascript-execution-concepts/">자바스크립트 동작 원리에대한 개념 정리</a><li><a href="/posts/linux-concept-is-confused/">리눅스 헷갈리는 개념 포스팅</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/gc/">gc</a> <a class="post-tag" href="/tags/garbege-collector/">garbege collector</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/anotation/">anotation</a> <a class="post-tag" href="/tags/chmod/">chmod</a> <a class="post-tag" href="/tags/cms-gc/">cms gc</a> <a class="post-tag" href="/tags/collaberations/">collaberations</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mvc-testing/"><div class="card-body"> <em class="timeago small" data-ts="1656760440" > 2022-07-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring Boot와 @WebMVCTest로 MVC Controller를 테스트 하는 방법</h3><div class="text-muted small"><p> 이 글은 Testing MVC Web Controllers with Spring Boot and @WebMvcTest을 해석하고 정리한 글입니다. 이번 글에서는 Controller에 대해 살펴볼 것이다. 먼저 책임 전체를 수용하는 테스트를 작성하기 위해 web Controller가 무엇을 하는지 탐색할 것이다. 그러고 각각 책임을 수용하는 테스트를 ...</p></div></div></a></div><div class="card"> <a href="/posts/validation-with-spring-boot/"><div class="card-body"> <em class="timeago small" data-ts="1647071640" > 2022-03-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스프링 부트 검증 완벽 가이드</h3><div class="text-muted small"><p> 스프링 부트 예외처리 완벽 가이드에 이어 스프링 부트에서 지원하는 검증 방법을 배우고 예시를 들며 설명하려고 합니다. Validation with Spring Boot - the Complete Guid를 번역했습니다. Bean Validation은 자바 생태계에서 검증 로직 구현의 사실상 기준이다. 스프링과 스프링 부트와 잘 통합된다. 하지만, ...</p></div></div></a></div><div class="card"> <a href="/posts/gc-tuning/"><div class="card-body"> <em class="timeago small" data-ts="1654967640" > 2022-06-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가비지 컬렉터 튜닝</h3><div class="text-muted small"><p> 지난 이야기 Garbage Collector에 대해 정리해놓은 글에서 Reference &amp;amp; Reachable Object와 Heap 영역의 구조, GC 알고리즘에 대해 설명했습니다. 이번 시간에는 Parallel Collector에 대해 조금 더 설명한 후에 GC 튜닝 방법에 대해 설명하려고 합니다. Parallel Collector (Thro...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/jvm/" class="btn btn-outline-primary" prompt="Older"><p>JVM의 구조와 GC</p></a> <a href="/posts/validation-with-spring-boot/" class="btn btn-outline-primary" prompt="Newer"><p>스프링 부트 검증 완벽 가이드</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/oopty">oopty</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/gc/">gc</a> <a class="post-tag" href="/tags/garbege-collector/">garbege collector</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/anotation/">anotation</a> <a class="post-tag" href="/tags/chmod/">chmod</a> <a class="post-tag" href="/tags/cms-gc/">cms gc</a> <a class="post-tag" href="/tags/collaberations/">collaberations</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-D6L4PXVM2Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-D6L4PXVM2Z'); }); </script>
