<!DOCTYPE html><html lang="custom" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="ko"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Java의 공통 메서드" /><meta property="og:locale" content="custom" /><meta name="description" content="안녕하세요, 오랜만에 글을 남기는데 회사에서 부서이동도 하고 출장도 갔다오면서 바쁜 나날을 보내 블로그 포스팅은 잠시 접어 두었네요. Effective Java를 읽으면서 내용 정리를 해보려고 합니다. 공부 기록 목적도 있고 복습 차원에서 글을 남기는 점 고려하시고 틀린 내용은 지적 부탁드리겠습니다~!" /><meta property="og:description" content="안녕하세요, 오랜만에 글을 남기는데 회사에서 부서이동도 하고 출장도 갔다오면서 바쁜 나날을 보내 블로그 포스팅은 잠시 접어 두었네요. Effective Java를 읽으면서 내용 정리를 해보려고 합니다. 공부 기록 목적도 있고 복습 차원에서 글을 남기는 점 고려하시고 틀린 내용은 지적 부탁드리겠습니다~!" /><link rel="canonical" href="https://oopty.github.io/posts/java-common-methods/" /><meta property="og:url" content="https://oopty.github.io/posts/java-common-methods/" /><meta property="og:site_name" content="oopty" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-08T09:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java의 공통 메서드" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-08T09:00:00+09:00","datePublished":"2023-01-08T09:00:00+09:00","description":"안녕하세요, 오랜만에 글을 남기는데 회사에서 부서이동도 하고 출장도 갔다오면서 바쁜 나날을 보내 블로그 포스팅은 잠시 접어 두었네요. Effective Java를 읽으면서 내용 정리를 해보려고 합니다. 공부 기록 목적도 있고 복습 차원에서 글을 남기는 점 고려하시고 틀린 내용은 지적 부탁드리겠습니다~!","headline":"Java의 공통 메서드","mainEntityOfPage":{"@type":"WebPage","@id":"https://oopty.github.io/posts/java-common-methods/"},"url":"https://oopty.github.io/posts/java-common-methods/"}</script><title>Java의 공통 메서드 | oopty</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="oopty"><meta name="application-name" content="oopty"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /commons/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">oopty</a></div><div class="site-subtitle font-italic">Stand on the shoulders of giants</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/oopty" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['minjun13795','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Java의 공통 메서드</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java의 공통 메서드</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/oopty">oopty</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1673136000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-08 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2809 words"> <em>15 min</em> read</span></div></div></div><div class="post-content"><p>안녕하세요, 오랜만에 글을 남기는데 회사에서 부서이동도 하고 출장도 갔다오면서 바쁜 나날을 보내 블로그 포스팅은 잠시 접어 두었네요. Effective Java를 읽으면서 내용 정리를 해보려고 합니다. 공부 기록 목적도 있고 복습 차원에서 글을 남기는 점 고려하시고 틀린 내용은 지적 부탁드리겠습니다~!</p><p>먼저 자바에서 기본 타입이 아닌 모든 객체는 <code class="language-plaintext highlighter-rouge">Object</code>를 상속하고 있습니다. 따라서 이 <code class="language-plaintext highlighter-rouge">Object</code>가 제공하는 <code class="language-plaintext highlighter-rouge">equals</code>, <code class="language-plaintext highlighter-rouge">hashCode</code>, <code class="language-plaintext highlighter-rouge">toString</code>메서드는 모든 객체가 사용할 수 있습니다. <code class="language-plaintext highlighter-rouge">clone</code>, <code class="language-plaintext highlighter-rouge">compare</code> 메서드는 각각 <code class="language-plaintext highlighter-rouge">Clonable</code>, <code class="language-plaintext highlighter-rouge">Comparable</code> 인터페이스를 구현하면 사용할 수 있습니다. 각 메서드를 오버라이드해서 재정의하는 편이 좋은지 아니면 상위 클래스가 구현한 대로 사용하는 편이 좋은지 판단하는 방법을 말씀드릴 겁니다. 먼저 <code class="language-plaintext highlighter-rouge">equals</code>부터 살펴보겠습니다~</p><h2 id="eqauls"><span class="mr-2">eqauls</span><a href="#eqauls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Object의 eqauls 메서드 구현은 아래와 같습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">obj</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>소스 코드에서 보듯이 메모리에 정확히 같이 위치한 객체만이 동일하다고 판단합니다. 이렇게 비교하면 모든 중요 필드를 비교하지 않아도 한번이 비교로 판단할 수 있으니 효과적입니다. 하지만 이렇게 동일성을 비교하는 것이 아닌 동등성을 비교하는 것이라면 아래와 같이 equals 매서드를 오버라이드해서 재정의 해줘야 합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">eqauls</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span><span class="o">(!</span><span class="n">obj</span> <span class="n">instaceOf</span> <span class="nc">MyClass</span><span class="o">)</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="nc">MyClass</span> <span class="n">o</span> <span class="o">=</span> <span class="o">(</span><span class="nc">MyClass</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">field1</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="na">field1</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="na">field2</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="na">field2</span><span class="o">;</span> <span class="c1">// 중요 필드 비교</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 재정의를 할 때 주의해야할 부분이 있습니다. 바로 eqauls 생성 규칙에 맞아야 하는데요 이걸 지키지 않으면 이를 사용하는 Collection에서 기대하는 대로 동작하지 않을 수 있습니다.</p><ol><li>reflexive (반사성), x.eqauls(x)는 항상 참이어야 한다.<li>symmetric (대칭성), x.equals(y)가 참일 때만, y.equals(x)가 참이어야 한다<li>transitive (추이성) 만약 x.eqauls(y)와 y.equals(z)가 참이 라면, x.equals(z)가 참이어야 한다.<li>consistent (일관성) if x.eqauls(y)가 참이거나 거짓이라면 객체 안의 값이 변경되지 않는 한 계속 참이거나 거짓이어야 한다.<li>x.eqauls(null)는 항상 거짓이어야 한다.</ol><p>그리고 상속을 통해 값을 추가하고 <code class="language-plaintext highlighter-rouge">equals</code>메서드를 재정의하려고 해서는 안됩니다. 위 5가지를 지키면서 <code class="language-plaintext highlighter-rouge">equals</code>메서드를 재정의하는 방법이 없기 때문입니다. 값을 추가하고 싶다면 상속이 아닌 해당 클래스를 필드로 두어서 해결해야 합니다. 자바 라이브러리에서도 이를 지키짐 못한 클래스가 있는데 바로 <code class="language-plaintext highlighter-rouge">java.util.Date</code>를 확장한 <code class="language-plaintext highlighter-rouge">java.sql.Timestamp</code>클래스입니다. <code class="language-plaintext highlighter-rouge">nanoseconds</code>필드를 추가해서 eqauls의 대칭성이 위배되었습니다. 그래서 Date 클래스와 같이 쓸 때 주의해야 합니다. equals를 재정의할 때 각 필드마다 어떻게 비교를 해야하는지 팁을 주자면 float와 double을 제외한 기본 타입을 비교할 때는 == 연산자를 사용하고 float와 double은 Float.compare(float, float), Double.compare(double, double)을 사용합니다. 객체는 equals 메서드를 재귀적으로 타면 됩니다.</p><p>equals 매서드는 동등성 검사를 꼭 해야하는 상황이 아니면 재정의하지 않는 편이 좋다고 합니다. 그리고 재정의 할 때는 위 다섯가지 규칙을 꼭 지켜야 합니다.</p><h2 id="hashcode"><span class="mr-2">hashCode</span><a href="#hashcode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">equals</code>를 재정의했다면 <code class="language-plaintext highlighter-rouge">hashCode</code>도 재정의를 해야합니다. 그렇지 않다면 아래 코드가 기대와 다르게 동작할 수 있습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">MyKey</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyKey</span><span class="o">(</span><span class="s">"mytest"</span><span class="o">),</span> <span class="mi">1</span><span class="o">);</span>

<span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyKey</span><span class="o">(</span><span class="s">"mytest"</span><span class="o">));</span> <span class="c1">// null을 반환</span>
</pre></table></code></div></div><p>첫번째 객체와 두번째 객체의 hashCode가 다르기 때문에 값이 다른 버킷에 들어가 있고 원하는 결과인 1이 나오지 않습니다.</p><p>hashCode를 재정의할 때는 아래와 같이 전에 계산했던 해시값에 31을 곱해주면서 반복적으로 값을 계산하는 방식이 대중적입니다. <code class="language-plaintext highlighter-rouge">Objects.hash</code>는 느려서 사용을 지양합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field1</span><span class="o">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field2</span><span class="o">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field3</span><span class="o">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>그리고 불변 객체라면 hashCode가 바뀌지 않기 때문에 이를 캐싱해 놓을 수 있는데 이 때는 thread-safe하게 작성해야 합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">hashCode</span><span class="o">;</span>
  <span class="k">if</span><span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field1</span><span class="o">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field2</span><span class="o">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="nc">Short</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">field3</span><span class="o">);</span>
    <span class="n">hashCode</span> <span class="o">=</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  
  <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>hashCode 반환 값과 만드는 규칙은 최대한 client에게서 감춰야 합니다. 그렇게 해야 client 코드와 상관없이 hashCode를 유연하게 고칠 수 있습니다.</p><h2 id="tostring"><span class="mr-2">toString</span><a href="#tostring" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>toString은 항상 재정의를 해줘서 디버깅을 쉽게 도와주게 해주는게 좋습니다. 객체가 가진 거의 모든 정보를 반환해주는게 좋고 포맷은 정확히 표시하고 추후 바뀌지 않을 것이라고 확신이 들면 정확한 설명을 해야합니다.</p><p>그렇지 않다면 “해당 toString의 상세 형식은 정해지지 않았으며 향후 변경될 수 있습니다”라는 문구를 추가해주는 것이 좋습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="cm">/** 상세 형식은 정해지지 않았으며 향후 변경될 수 있습니다.
* "[약물 #9: 유형=사랑, 냄새=내레빈유, 겉모습=먹물]"
*/</span>
<span class="nd">@Override</span> <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{...}</span>
</pre></table></code></div></div><p>이렇게 하면서 toString의 반환값을 파싱해서 클라이언트가 사용하는 것을 막을 수 있습니다.</p><h2 id="clone"><span class="mr-2">clone</span><a href="#clone" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>clone 메서드는 Object 클래스에 명세가 있고 사용 여부는 Clonable 인터페이스 구현으로 제어하는 방식입니다. Clonable 인터페이스를 구현하면 구현한 클래스의 상위 클래스의 clone 메서드를 수정합니다. 상위 클래스의 모든 필드를 복사 후 반환하고 구현하지 않는다면 상위 클래스의 clone 메서드를 호출 시 CloneNotSupportedException을 던집니다. 매우 예외적으로 인터페이스를 사용한 경우라 따라하시면 안됩니다. clone 메서드를 구현할 때는 기존 <code class="language-plaintext highlighter-rouge">protected</code>로 되어 있던 접근 제어자를 <code class="language-plaintext highlighter-rouge">public</code>으로 바꿔주고 상위 클래스의 clone 메서드를 호출 후 자신의 클래스로 형 변환을 해주어 클라이언트에서 편리하게 사용할 수 있게 해줍니다. 클래스에 추가 필드가 있다면 해당 필드도 복사하는 로직을 넣어줍니다. 그리고 CloneNotSupportedException는 clone을 구현했으므로 try-catch로 묶어서 unchecked exception으로 변환해서 던집니다.(<code class="language-plaintext highlighter-rouge">AssertionError</code>) 만약 가변 객체를 필드로 가지고 있다면 문제가 복잡해집니다. 해당 가변 객체를 deep copy하는 로직을 직접 작성해야 하며 이로 인해 성능 이슈가 생길 수 있으니 신중히 작성해야 합니다. 그리고 가변 객체 필드를 final로 작성할 수 없어서 <code class="language-plaintext highlighter-rouge">모든 가변 객체는 final이어야 한다</code>는 원칙을 위배하는 경우입니다. 이펙티브 자바에서 말하기를 clone 메서드 구현보다 복사 생성자나 복사 팩터리를 구현하는게 더 좋은 방법이라고 합니다. 이 경우에는 가변 객체 필드를 final로 선언할 수 있고 불필요한 형변환을 해야할 필요가 없으며 예외 검사를 할 필요도 없습니다.</p><h2 id="comparable"><span class="mr-2">Comparable</span><a href="#comparable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Comparable 인터페이스는 compareTo(T o) 시그니처 형태에 메서드로 객체의 순서를 지정해주는 역할을 합니다. 이는 Collection에서 쓰이기 해서 순서를 고려해야 하는 클래스이면 꼭 작성해야 합니다. compareTo 메서드 일반 규약은 equals 메서드와 비슷합니다.</p><ul><li>모든 x, y에 대해 sgn(x.compareTo(y)) == -sgn(y.compareTo(x)) 입니다.<li>추이성으로 보장해야 합니다. x.compareTo(y) &gt; 0 &amp;&amp; y.compareTo(z) &gt; 0 이면 x.compare(z) &gt; 0 입니다.<li>모든 z에 대해 x.compareTo(y) = 0 이면 x.compare(z) = y.compareTo(z) 입니다.<li>이거는 꼭 지킬 필요는 없지만 권고사항입니다. x.compareTo(y) = 0 이면 x.eqauls(y)는 참입니다. 이를 지키지 않는다면 명시를 해야합니다.</ul><p>네번째 룰을 어긴 것이 BigInteger입니다. 사용할 때 주의가 조금 필요합니다.</p><p>compareTo를 구현할 때 &gt;, &lt; 같은 관계연산자를 사용하면 에러가 날 수 있으므로 java7 이상을 사용한다면 박싱된 기본 타입의 compare메서드를 이용하셔야 합니다. 이를 이용해서 구현하면 아래와 같은 패턴으로 작성할 수 있습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="nc">PhoneNumber</span> <span class="n">pn</span><span class="o">)</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">areaCode</span><span class="o">,</span> <span class="n">pn</span><span class="o">.</span><span class="na">areaCode</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">prefix</span><span class="o">,</span> <span class="n">pn</span><span class="o">.</span><span class="na">prefix</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">lineNum</span><span class="o">,</span> <span class="n">pn</span><span class="o">.</span><span class="na">lineNum</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이를 아래와 같이 Comparator 인터페이스의 비교자 생성 메서드로 구현하면 간단하다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Comparator</span><span class="o">&lt;</span><span class="nc">PhoneNumber</span><span class="o">&gt;</span> <span class="no">COMPARATOR</span> <span class="o">=</span>
  <span class="n">comparingInt</span><span class="o">((</span><span class="nc">PhoneNumber</span> <span class="n">pn</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">pn</span><span class="o">.</span><span class="na">areaCode</span><span class="o">)</span>
    <span class="o">.</span><span class="na">thenComparingInt</span><span class="o">(</span><span class="n">pn</span> <span class="o">-&gt;</span> <span class="n">pn</span><span class="o">.</span><span class="na">prefix</span><span class="o">)</span>
    <span class="o">.</span><span class="na">thenComparingINt</span><span class="o">(</span><span class="n">pn</span> <span class="o">-&gt;</span> <span class="n">pn</span><span class="o">.</span><span class="na">lineNum</span><span class="o">);</span>

<span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="nc">PhoneNumber</span> <span class="n">pn</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="no">COMPARATOR</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">pn</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이따금 ‘값의 차’를 이용해 compareTo를 구현하려고 하는 경우가 있습니다. 저도 이렇게 많이 했는데 이러면 정수 오버플로우를 일으켜 추이성이 깨지거나 IEEE 754 부동소수점 계산방식에 의해 오류가 날 수 있습니다. 그래서 아래와 같이 박싱된 기본 타입의 compare 메서드로 구현을 합시다</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">static</span> <span class="nc">Comparator</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">hashCodeOrder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Comparator</span><span class="o">&lt;&gt;()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="nc">Object</span> <span class="n">o1</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">o2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">o1</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(),</span> <span class="n">o2</span><span class="o">.</span><span class="na">hashCoe</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 Object 클래스에 있는 기본메서드와 Comparable 인터페이스에 대해 알아보았는데 각 메서드의 일반 규약을 살펴보고 해당 규약에 맞춰 개발해야 한다는게 이번 챕터의 메인 주제였습니다. 이펙티브 자바를 보면서 기존에 제가 작성했던 코드에 대해 생각하게 되고 좀 더 좋은 코드를 작성할 수 있게 제 손가락에 내재화 시켜야겠습니다. 🤔</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>java</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/effective-java/" class="post-tag no-text-decoration" >effective java</a> <a href="/tags/object/" class="post-tag no-text-decoration" >Object</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java%EC%9D%98+%EA%B3%B5%ED%86%B5+%EB%A9%94%EC%84%9C%EB%93%9C+-+oopty&url=https%3A%2F%2Foopty.github.io%2Fposts%2Fjava-common-methods%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java%EC%9D%98+%EA%B3%B5%ED%86%B5+%EB%A9%94%EC%84%9C%EB%93%9C+-+oopty&u=https%3A%2F%2Foopty.github.io%2Fposts%2Fjava-common-methods%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Foopty.github.io%2Fposts%2Fjava-common-methods%2F&text=Java%EC%9D%98+%EA%B3%B5%ED%86%B5+%EB%A9%94%EC%84%9C%EB%93%9C+-+oopty" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/effective-java-item-1/">Effective Java 정리 Item1</a><li><a href="/posts/gc-tuning/">가비지 컬렉터 튜닝</a><li><a href="/posts/java-study1/">함수형 프로그래밍의 의미와 장점</a><li><a href="/posts/javascript-execution-concepts/">자바스크립트 동작 원리에대한 개념 정리</a><li><a href="/posts/linux-concept-is-confused/">리눅스 헷갈리는 개념 포스팅</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/gc/">gc</a> <a class="post-tag" href="/tags/garbege-collector/">garbege collector</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/anotation/">anotation</a> <a class="post-tag" href="/tags/chmod/">chmod</a> <a class="post-tag" href="/tags/cms-gc/">cms gc</a> <a class="post-tag" href="/tags/collaberations/">collaberations</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mvc-testing/"><div class="card-body"> <em class="timeago small" data-ts="1656760440" > 2022-07-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring Boot와 @WebMVCTest로 MVC Controller를 테스트 하는 방법</h3><div class="text-muted small"><p> 이 글은 Testing MVC Web Controllers with Spring Boot and @WebMvcTest을 해석하고 정리한 글입니다. 이번 글에서는 Controller에 대해 살펴볼 것이다. 먼저 책임 전체를 수용하는 테스트를 작성하기 위해 web Controller가 무엇을 하는지 탐색할 것이다. 그러고 각각 책임을 수용하는 테스트를 ...</p></div></div></a></div><div class="card"> <a href="/posts/gc-tuning/"><div class="card-body"> <em class="timeago small" data-ts="1654967640" > 2022-06-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가비지 컬렉터 튜닝</h3><div class="text-muted small"><p> 지난 이야기 Garbage Collector에 대해 정리해놓은 글에서 Reference &amp;amp; Reachable Object와 Heap 영역의 구조, GC 알고리즘에 대해 설명했습니다. 이번 시간에는 Parallel Collector에 대해 조금 더 설명한 후에 GC 튜닝 방법에 대해 설명하려고 합니다. Parallel Collector (Thro...</p></div></div></a></div><div class="card"> <a href="/posts/why-be-generic-used-in-java/"><div class="card-body"> <em class="timeago small" data-ts="1676678400" > 2023-02-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>왜 제네릭을 쓰는 걸까?</h3><div class="text-muted small"><p> 자바 소스코드를 보다보면 제네릭을 사용한 코드를 많이 볼 수 있습니다. 제네릭에 대해서는 단순 타입을 지정해서 사용하는 것이다 정도만 알고 있으니 해당 코드에 대해 정확히 이해하지 못하고 제가 제네릭을 활용하려 할 때 한계가 있었습니다 그래서 제네릭이 언제 도입되었는지 왜 사용하는지를 나름 정리해서 업무에 활용해보려고 합니다. 제네릭을 사용하는 이유...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mvc-testing/" class="btn btn-outline-primary" prompt="Older"><p>Spring Boot와 @WebMVCTest로 MVC Controller를 테스트 하는 방법</p></a> <a href="/posts/why-be-generic-used-in-java/" class="btn btn-outline-primary" prompt="Newer"><p>왜 제네릭을 쓰는 걸까?</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/oopty">oopty</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/effectivejava/">effectivejava</a> <a class="post-tag" href="/tags/gc/">gc</a> <a class="post-tag" href="/tags/garbege-collector/">garbege collector</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/anotation/">anotation</a> <a class="post-tag" href="/tags/chmod/">chmod</a> <a class="post-tag" href="/tags/cms-gc/">cms gc</a> <a class="post-tag" href="/tags/collaberations/">collaberations</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-D6L4PXVM2Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-D6L4PXVM2Z'); }); </script>
